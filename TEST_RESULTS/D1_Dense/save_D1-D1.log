Feature Extraction
Running with parameters: 
  action: save
  name: D1_Dense
  modality: ['RGB']
  total_batch: 128
  batch_size: 32
  gpus: None
  wandb_name: None
  resume_from: ./saved_models/I3D_SourceOnlyD1
  logname: save_D1-D1.log
  models_dir: saved_models/D1_Dense/Jan11_22-10-54
  train:
    num_iter: 5000
    lr_steps: 3000
    eval_freq: 50
    num_clips: 1
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  test:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  dataset:
    annotations_path: train_val
    shift: D1-D1
    workers: 4
    stride: 2
    resolution: 224
    RGB:
      data_path: ../ek_data/frames
      tmpl: img_{:010d}.jpg
      features_name: test_feat_kinetics
    Event:
      rgb4e: 6
  models:
    RGB:
      model: I3D
      normalize: False
      kwargs:
      lr_steps: 3000
      lr: 0.01
      sgd_momentum: 0.9
      weight_decay: 1e-07
      dropout: 0.5
      resolution: 224
      weight_i3d_rgb: ./pretrained_i3d/rgb_imagenet.pt
  split: test
  save:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  config: configs/I3D_save_feat.yaml
  experiment_dir: D1_Dense/Jan11_22-10-54
  log_dir: TEST_RESULTS/D1_Dense
  logfile: TEST_RESULTS/D1_Dense/save_D1-D1.log
Instantiating models per modality
I3D Net	Modality: RGB
Loading Kinetics weights I3D
 * Skipping Logits weight for 'logits.conv3d.weight'
 * Skipping Logits weight for 'logits.conv3d.bias'
Restoring action-classifier for modality RGB from saved_models/I3D_SourceOnlyD1/Oct25_22-38-50/action-classifier_RGB_8.pth
RGB-Model for action-classifier restored at iter 4800.0
Best accuracy on val: 59.54 at iter 4000.0
Last accuracy on val: 58.16
Last loss: 0.00
Dataloader for D1-test with 435 samples generated
Uncaught exception
Traceback (most recent call last):
  File "/content/aml23-ego/save_feat.py", line 159, in <module>
    main()
  File "/content/aml23-ego/save_feat.py", line 70, in main
    save_feat(action_classifier, loader, device, action_classifier.current_iter, num_classes)
  File "/content/aml23-ego/save_feat.py", line 94, in save_feat
    for i_val, (data, label, video_name, uid) in enumerate(loader):
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/usr/local/lib/python3.10/dist-packages/torch/_utils.py", line 694, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/content/aml23-ego/utils/loaders.py", line 163, in __getitem__
    segment_indices[modality] = self._get_val_indices(record, modality)
  File "/content/aml23-ego/utils/loaders.py", line 128, in _get_val_indices
    raise ValueError(
ValueError: Invalid number of frames: got 59, expected 80

Feature Extraction
Running with parameters: 
  action: save
  name: D1_Dense
  modality: ['RGB']
  total_batch: 128
  batch_size: 32
  gpus: None
  wandb_name: None
  resume_from: ./saved_models/I3D_SourceOnlyD1
  logname: save_D1-D1.log
  models_dir: saved_models/D1_Dense/Jan11_22-18-57
  train:
    num_iter: 5000
    lr_steps: 3000
    eval_freq: 50
    num_clips: 1
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  test:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  dataset:
    annotations_path: train_val
    shift: D1-D1
    workers: 4
    stride: 2
    resolution: 224
    RGB:
      data_path: ../ek_data/frames
      tmpl: img_{:010d}.jpg
      features_name: test_feat_kinetics
    Event:
      rgb4e: 6
  models:
    RGB:
      model: I3D
      normalize: False
      kwargs:
      lr_steps: 3000
      lr: 0.01
      sgd_momentum: 0.9
      weight_decay: 1e-07
      dropout: 0.5
      resolution: 224
      weight_i3d_rgb: ./pretrained_i3d/rgb_imagenet.pt
  split: test
  save:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  config: configs/I3D_save_feat.yaml
  experiment_dir: D1_Dense/Jan11_22-18-57
  log_dir: TEST_RESULTS/D1_Dense
  logfile: TEST_RESULTS/D1_Dense/save_D1-D1.log
Instantiating models per modality
I3D Net	Modality: RGB
Loading Kinetics weights I3D
 * Skipping Logits weight for 'logits.conv3d.weight'
 * Skipping Logits weight for 'logits.conv3d.bias'
Restoring action-classifier for modality RGB from saved_models/I3D_SourceOnlyD1/Oct25_22-38-50/action-classifier_RGB_8.pth
RGB-Model for action-classifier restored at iter 4800.0
Best accuracy on val: 59.54 at iter 4000.0
Last accuracy on val: 58.16
Last loss: 0.00
Dataloader for D1-test with 435 samples generated
[87/435] top1= 59.770% top5 = 96.552%
[174/435] top1= 59.770% top5 = 97.701%
[261/435] top1= 59.004% top5 = 97.701%
[348/435] top1= 57.759% top5 = 97.414%
[435/435] top1= 55.402% top5 = 97.931%
Final accuracy: top1 = 55.40%	top5 = 97.93%
Class 0 = [62/124] = 50.00%
Class 1 = [64/104] = 61.54%
Class 2 = [32/52] = 61.54%
Class 3 = [11/34] = 32.35%
Class 4 = [47/66] = 71.21%
Class 5 = [7/13] = 53.85%
Class 6 = [13/20] = 65.00%
Class 7 = [5/22] = 22.73%
Accuracy by averaging class accuracies (same weight for each class): 52.27692650486768%
Feature Extraction
Running with parameters: 
  action: save
  name: D1_Dense
  modality: ['RGB']
  total_batch: 128
  batch_size: 32
  gpus: None
  wandb_name: None
  resume_from: ./saved_models/I3D_SourceOnlyD1
  logname: save_D1-D1.log
  models_dir: saved_models/D1_Dense/Jan13_18-22-06
  train:
    num_iter: 5000
    lr_steps: 3000
    eval_freq: 50
    num_clips: 1
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  test:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  dataset:
    annotations_path: train_val
    shift: D1-D1
    workers: 4
    stride: 2
    resolution: 224
    RGB:
      data_path: ../ek_data/frames
      tmpl: img_{:010d}.jpg
      features_name: test_feat_kinetics
    Event:
      rgb4e: 6
  models:
    RGB:
      model: I3D
      normalize: False
      kwargs:
      lr_steps: 3000
      lr: 0.01
      sgd_momentum: 0.9
      weight_decay: 1e-07
      dropout: 0.5
      resolution: 224
      weight_i3d_rgb: ./pretrained_i3d/rgb_imagenet.pt
  split: train
  save:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  config: configs/I3D_save_feat.yaml
  experiment_dir: D1_Dense/Jan13_18-22-06
  log_dir: TEST_RESULTS/D1_Dense
  logfile: TEST_RESULTS/D1_Dense/save_D1-D1.log
Instantiating models per modality
I3D Net	Modality: RGB
Loading Kinetics weights I3D
 * Skipping Logits weight for 'logits.conv3d.weight'
 * Skipping Logits weight for 'logits.conv3d.bias'
Restoring action-classifier for modality RGB from saved_models/I3D_SourceOnlyD1/Oct25_22-38-50/action-classifier_RGB_8.pth
RGB-Model for action-classifier restored at iter 4800.0
Best accuracy on val: 59.54 at iter 4000.0
Last accuracy on val: 58.16
Last loss: 0.00
Dataloader for D1-train with 1543 samples generated
Feature Extraction
Running with parameters: 
  action: save
  name: D1_Dense
  modality: ['RGB']
  total_batch: 128
  batch_size: 32
  gpus: None
  wandb_name: None
  resume_from: ./saved_models/I3D_SourceOnlyD1
  logname: save_D1-D1.log
  models_dir: saved_models/D1_Dense/Jan13_18-23-11
  train:
    num_iter: 5000
    lr_steps: 3000
    eval_freq: 50
    num_clips: 1
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  test:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  dataset:
    annotations_path: train_val
    shift: D1-D1
    workers: 4
    stride: 2
    resolution: 224
    RGB:
      data_path: ../ek_data/frames
      tmpl: img_{:010d}.jpg
      features_name: test_feat_kinetics
    Event:
      rgb4e: 6
  models:
    RGB:
      model: I3D
      normalize: False
      kwargs:
      lr_steps: 3000
      lr: 0.01
      sgd_momentum: 0.9
      weight_decay: 1e-07
      dropout: 0.5
      resolution: 224
      weight_i3d_rgb: ./pretrained_i3d/rgb_imagenet.pt
  split: train
  save:
    num_clips: 5
    dense_sampling:
      RGB: True
    num_frames_per_clip:
      RGB: 16
  config: configs/I3D_save_feat.yaml
  experiment_dir: D1_Dense/Jan13_18-23-11
  log_dir: TEST_RESULTS/D1_Dense
  logfile: TEST_RESULTS/D1_Dense/save_D1-D1.log
Instantiating models per modality
I3D Net	Modality: RGB
Loading Kinetics weights I3D
 * Skipping Logits weight for 'logits.conv3d.weight'
 * Skipping Logits weight for 'logits.conv3d.bias'
Restoring action-classifier for modality RGB from saved_models/I3D_SourceOnlyD1/Oct25_22-38-50/action-classifier_RGB_8.pth
RGB-Model for action-classifier restored at iter 4800.0
Best accuracy on val: 59.54 at iter 4000.0
Last accuracy on val: 58.16
Last loss: 0.00
Dataloader for D1-train with 1543 samples generated
[308/1543] top1= 91.558% top5 = 100.000%
[616/1543] top1= 92.532% top5 = 100.000%
[924/1543] top1= 92.424% top5 = 99.892%
[1232/1543] top1= 92.695% top5 = 99.919%
[1540/1543] top1= 92.468% top5 = 99.935%
Final accuracy: top1 = 92.48%	top5 = 99.94%
Class 0 = [397/421] = 94.30%
Class 1 = [351/383] = 91.64%
Class 2 = [206/231] = 89.18%
Class 3 = [114/128] = 89.06%
Class 4 = [215/223] = 96.41%
Class 5 = [64/71] = 90.14%
Class 6 = [41/42] = 97.62%
Class 7 = [39/44] = 88.64%
Accuracy by averaging class accuracies (same weight for each class): 92.12412469803112%
